<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<title>Jakarta Servlet</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Jakarta Servlet</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_введение_в_сервлеты">Введение в сервлеты</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Сервлет представляет специальный тип классов Java, который выполняется на веб-сервере и который обрабатывает запросы и возвращает результат обработки.</p>
</div>
<div class="paragraph">
<p>Создадим первый сервлет. Определим где-нибудь на жестком диске файл <code>HelloServlet.java</code> со следующим кодом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		response.setContentType("text/html");
		PrintWriter writer = response.getWriter();
		try {
			writer.println("&lt;h2&gt;Hello from HelloServlet&lt;/h2&gt;");
		} finally {
			writer.close();
		}
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Класс сервлета наследуется от класса <code>HttpServlet</code>. Перед определением класса указана аннотация <code>@WebServlet</code>, которая указывает, с какой конечной точкой будет сопоставляться данный сервлет. То есть данный сервлет будет обрабатывать запросы по адресу <code>/hello</code>.</p>
</div>
<div class="paragraph">
<p>Для обработки <strong>GET</strong>-запросов (например, при обращении к сервлету из адресной строки браузера) сервлет должен переопределить метод <code>doGet()</code>. То есть, к примеру, в данном случае get-запрос по адресу <code>/hello</code> будет обрабатываться методом <code>doGet()</code>.</p>
</div>
<div class="paragraph">
<p>Этот метод принимает два параметра. Параметр типа <code>HttpServletRequest</code> инкапсулирует всю информацию о запросе. А параметр типа <code>HttpServletResponse</code> позволяет управлять ответом. В частности, с помощью вызова <code>response.setContentType("text/html")</code> устанавливается тип ответа (в данном случае, мы говорим, что ответ представляет код html). А с помощью метода <code>getWriter()</code> объекта <code>HttpServletResponse</code> мы можем получить объект <code>PrintWriter</code>, через который можно отправить какой-то определенный ответ пользователю. В данном случае через метод <code>println()</code> пользователю отправляет простейший html-код. По завершению использования объекта <code>HttpServletResponse</code> его необходимо закрыть с помощью метода <code>close()</code>.</p>
</div>
<div class="paragraph">
<p>Для запуска сервлета воспользуемся опять же контейнером сервлетов <em>Apache Tomcat</em>. В каталоге <em>Tomcat</em> в папке <code>webapps</code> создадим каталог для нового приложения, который назовем <code>helloapp</code>.</p>
</div>
<div class="paragraph">
<p>В папке приложения классы сервлетов должны размещаться в папке <code>WEB-INF/classes</code>. Создадим в каталоге <code>helloapp</code> папку <code>WEB-INF</code>, а в ней папку <code>classes</code>. И в папку <code>helloapp/WEB-INF/classes</code> поместим файл <code>HelloServlet.java</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet1.png" alt="servlet1"></span></p>
</div>
<div class="paragraph">
<p>Но нам нужен не код сервлета, а скомпилированный класс сервлета. Поэтому скомпилируем сервлет. Для этого нам нужно использовать специальную утилиту <code>servlet-api.jar</code>, которая находится в каталоге Tomcat в папке <code>lib</code>.</p>
</div>
<div class="paragraph">
<p>В начале в командной строке/терминале перейдем с помощью команды <code>cd</code> к папке <code>helloapp/WEB-INF/classes</code>, где расположен код сервлета.</p>
</div>
<div class="paragraph">
<p>Потом для компиляции сервлета выполним следующую команду:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-powershell" data-lang="powershell">javac -cp .;"C:\Program Files\Apache Software Foundation\Tomcat 9.0\lib\servlet-api.jar" HelloServlet.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>В моем случае предполагается, что Tomcat размещен в каталоге <code>C:\Program Files\Apache Software Foundation\Tomcat 9.0</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet2.png" alt="servlet2"></span></p>
</div>
<div class="paragraph">
<p>После этого в папке <code>helloapp/WEB-INF/classes</code> должен появиться класс сервлета. Перезапустим Tomcat и обратимся к нашему сервлету в браузере:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet3.png" alt="servlet3"></span></p>
</div>
<div class="paragraph">
<p>Поскольку с помощью аннотации <code>@WebServlet</code> в классе сервлета была указана точка <code>/hello</code>, то при обращении к сервлету после домена и порта идет название приложения (<code>helloapp</code>) и конечная точка (<code>hello</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_как_работает_сервлет">Как работает сервлет</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Сервлет</strong> - это класс, который расширяет функциональность класса <code>HttpServlet</code> и запускается внутри <strong>контейнера сервлетов</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Сервлет</strong> размещается на сервере, однако чтобы сервер мог использовать сервлет для обработки запросов, сервер должен поддерживать движок или контейнер сервлетов (<strong>servlet container/engine</strong>). Например, <em>Apache Tomcat</em> по сути является контейнером сервлетов, поэтому он может использовать сервлеты для обслуживания запросов.</p>
</div>
<div class="paragraph">
<p>Для обработки запроса в <code>HttpServlet</code> определен ряд методов, которые мы можем переопределить в классе сервлета:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>doGet()</code> обрабатывает запросы <strong>GET</strong> (получение данных)</p>
</li>
<li>
<p><code>doPost()</code> обрабатывает запросы <strong>POST</strong> (отправка данных)</p>
</li>
<li>
<p><code>doPut()</code> обрабатывает запросы <strong>PUT</strong> (отправка данных для изменения)</p>
</li>
<li>
<p><code>doDelete()</code> обрабатывает запросы <strong>DELETE</strong> (удаление данных)</p>
</li>
<li>
<p><code>doHead()</code> обрабатывает запросы <strong>HEAD</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Каждый метод обрабатывает определенный тип запросов <strong>HTTP</strong>, и мы можем определить все эти методы, но, зачастую, работа идет в основном с методами <code>doGet()</code> и <code>doPost()</code>. Например, определение методов без реализации:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    }

    protected void doPut(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    }

    protected void doDelete(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    }

    protected void doHead(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Все методы в качестве параметра принимают два объекта:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HttpServletRequest</code> хранит информацию о запросе</p>
</li>
<li>
<p><code>HttpServletResponse</code> управляет ответом на запрос.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_жизненный_цикл_сервлета">Жизненный цикл сервлета</h3>
<div class="paragraph">
<p>Для каждого сервлета движок сервлетов создает только одну копию. Вне зависимости от того, сколько запросов будет отправлено сервлету, все запросы будут обрабатываться толькой одной копией сервлета. Объект сервлета создается либо при запуске движка сервлетов, либо когда сервлет получает первый запрос. Затем для каждого запроса запускается поток, который обращается к объекту сервлета.</p>
</div>
<div class="paragraph">
<p>При работе с сервлетом движок сервлетов вызывает у класса сервлета ряд методов, которые определены в родительском абстрактном классе <code>HttpServlet</code>.</p>
</div>
<div class="paragraph">
<p>Когда движок сервлетов создает объект сервлета, у сервлета вызывается метод <code>init()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void init(ServletConfig config) throws ServletException {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот метод вызывается только один раз - при создании сервлета. Мы можем переопределить этот метод, чтобы определить в нем некоторую логику инициализации.</p>
</div>
<div class="paragraph">
<p>Когда к сервлету приходит запрос, движок сервлетов вызывает метод <code>service()</code> сервлета. А этот метод, исходя из типа запроса (<strong>GET</strong>, <strong>POST</strong>, <strong>PUT</strong> и т.д.) решает, какому методу сервлета (<code>doGet()</code>, <code>doPost()</code> и т.д.) обрабатывать этот запрос.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void service(HttpServletRequest request, HttpServletResponse response)
		throws IOException, ServletException {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Этот метод также можно переопределить, однако в этом нет смысла. В реальности для обработки запроса переопределяются методы <code>onGet()</code>, <code>onPost()</code> и т.д., которые обрабатывают конкретные типы запросов.</p>
</div>
<div class="paragraph">
<p>Если объект сервлета долгое время не используется (к нему нет никаких запросов), или если происходит завершение работы движка сервлетов, то движок сервлетов выгружает из памяти все созданные экземпляры сервлетов. Однако до выгрузки сервлета из памяти у сервлета вызывается метод <code>destroy()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void destroy() {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>При необходимости мы также можем его переопределить, например, определить в нем логику логгирования или что иное. В то же время следует учитывать, что если сервер вдруг упадет по какой-то причине, например, отключится электричество и т.д., тогда данный метод естественно не будет вызван и его логика не сработает.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/lifecycle.png" alt="Lifecycle"></span></p>
</div>
<div class="paragraph">
<p>Поскольку для обработки всех запросов создается один экземпляр сервлета, и все обращения к нему идут в отдельных потоках, то не рекомендуется в классе сервлета объявлять и использовать глобальные переменные, так как они не будут потокобезопасными.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_получение_данных_в_сервлете">Получение данных в сервлете</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В методы <code>doGet()</code> и <code>doPost()</code> сервлета, которые обрабатывают запрос, в качестве одного из параметров передается объект <code>HttpServletRequest</code>, с помощью которого можно получить отправленные сервлету данные, то есть параметры запроса. Для этого в классе <code>HttpServletRequest</code> определены два метода:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getParameter(String param)</code> возвращает значение определенного параметра, название которого передается в метод. Если указанного параметра в запросе нет, то возвращается значение <code>null</code>.</p>
</li>
<li>
<p><code>getParameterValues(String param)</code> возвращает массив значений, который представляет определенный параметр. Если указанного параметра в запросе нет, то возвращается значение <code>null</code>.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_получение_данных_из_строки_запроса">Получение данных из строки запроса</h3>
<div class="paragraph">
<p>Передавать значения в сервлет можно различными способами. При отправке <strong>GET</strong>-запроса значения передаются через строку запроса. Стандартный get-запрос принимает примерно следующую форму: <code>название_ресурса?параметр1=значение1&amp;параметр2=значение2</code>.</p>
</div>
<div class="paragraph">
<p>Например, определим следующий сервлет:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        // получаем параметр id
        String id = request.getParameter("id");
        try {
            writer.println("&lt;h2&gt;Id:" + id + "&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае мы предполагаем, что в сервлет в <strong>get</strong>-запросе передается значение/параметр по имени <code>id</code>. С помощью вызова <code>request.getParameter("id")</code> мы получаем значение этого параметра и затем отправляем его в ответ пользователю. При этом стоит учитывать, что неважно, что мы будем передавать извне - целое или дробное число, отдельный символ, в любом случае метод <code>getParameter()</code> возвратить строку.</p>
</div>
<div class="paragraph">
<p>Запустим приложение и обратимся к сервлету:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet7.jpg" alt="serlvet7"></span></p>
</div>
<div class="paragraph">
<p>В случае выше значение для параметра <code>id</code> не указано, мы просто вводим в адресной строке браузера название ресурса - в данном случае <code><a href="http://localhost:8081/helloapp/hello" class="bare">http://localhost:8081/helloapp/hello</a></code>, где <code>helloapp</code> - название приложения, а <code>hello</code> - конечная точка, к которой примонтирован сервлет. Поэтому метод <code>getParameter("id"</code>) возвращает значение <code>null</code>.</p>
</div>
<div class="paragraph">
<p>Теперь передадим значение для параметра <code>id</code>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet8.jpg" alt="servlet8"></span></p>
</div>
<div class="paragraph">
<p>Параметры в строке запроса указываютя после названия ресурса после знака вопроса:` <a href="http://localhost:8081/helloapp/hello?id=5`.В" class="bare">http://localhost:8081/helloapp/hello?id=5`.В</a> данном случае параметр <code>id</code> равен <code>5</code>.</p>
</div>
<div class="paragraph">
<p>Подобным образом можно передавать несколько параметров. Например, изменим сервлет следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        String name = request.getParameter("name");
        String age = request.getParameter("age");

        try {
            writer.println("&lt;h2&gt;Name: " + name + "; Age: " + age + "&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае сервлет получает два параметра: <code>name</code> и <code>age</code>. Мы можем передать значения для них, набрав в адресной строке, например,` <a href="http://localhost:8081/helloapp/hello?name=Tom&amp;age=34.`" class="bare">http://localhost:8081/helloapp/hello?name=Tom&amp;age=34.`</a> При передаче некольких параметров они отделяются друг от друга знаком амперсанда <code>&amp;</code>. Подобным образом мы можем передать и большее количество параметров.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet9.jpg" alt="servlet9"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_передача_массивов">Передача массивов</h3>
<div class="paragraph">
<p>В примерах выше передавались одиночные данные - отдельные строки. Но также мы можем передавать наборы значений. Например, изменим сервлет следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        String[] nums = request.getParameterValues("nums");

        try {
            writer.print("&lt;h2&gt;Numbers: ");
            for(String n: nums)
                writer.print(n + " ");
            writer.println("&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Если в сервлет передается массив значений, то для его получения у объекта <code>HttpServletRequest</code> применяется метод <code>getParameterValues()</code>, который получает название параметра и возвращает массив строк. В данном случае мы ожидаем, что параметр будет называться <code>nums</code>. Затем значения из этого параметра в цикле передаются в ответ клиенту.</p>
</div>
<div class="paragraph">
<p>Запустим сервлет и передадим ему значения</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet10.jpg" alt="servlet10"></span></p>
</div>
<div class="paragraph">
<p>При передаче массива через строку запроса указываются несколько значений с одним и тем же именем: <code><a href="http://localhost:8081/helloapp/hello?nums=1&amp;nums=2&amp;nums=3" class="bare">http://localhost:8081/helloapp/hello?nums=1&amp;nums=2&amp;nums=3</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_получение_данных_из_форм">Получение данных из форм</h3>
<div class="paragraph">
<p>Еще одним распространенным способом отправки данных является отправка форм. Добавим в проект страницу <code>index.html</code> со следующим кодом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;User Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="hello" method="POST"&gt;
        Name: &lt;input name="username" /&gt;
        &lt;br&gt;&lt;br&gt;
        Age: &lt;input name="userage" /&gt;
        &lt;br&gt;&lt;br&gt;
        Gender: &lt;input type="radio" name="gender" value="female" checked /&gt;Female
        &lt;input type="radio" name="gender" value="male" /&gt;Male
        &lt;br&gt;&lt;br&gt;
        Country: &lt;select name="country"&gt;
            &lt;option&gt;Canada&lt;/option&gt;
            &lt;option&gt;Spain&lt;/option&gt;
            &lt;option&gt;France&lt;/option&gt;
            &lt;option&gt;Germany&lt;/option&gt;
        &lt;/select&gt;
        &lt;br&gt;&lt;br&gt;
        Courses:
        &lt;input type="checkbox" name="courses" value="JavaSE" checked /&gt;Java SE
        &lt;input type="checkbox" name="courses" value="JavaFX" checked /&gt;Java FX
        &lt;input type="checkbox" name="courses" value="JavaEE" checked /&gt;Java EE
        &lt;br&gt;&lt;br&gt;
        &lt;input type="submit" value="Submit" /&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Как правило, формы отправлются с помощью запроса <strong>POST</strong>, поэтому у элемента формы определен атрибут <code>method="POST"</code>. Сама форма будет отправляться на ресурс <code>/hello</code>, с которым будет сопоставляться сервлет. На самой форме есть множество полей ввода, в том числе набор чекбоксов, из которых можно выбрать сразу несколько значений.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet11.jpg" alt="servlet11"></span></p>
</div>
<div class="paragraph">
<p>Теперь определим сервлет, который будет обрабатывать эту форму:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();

        String name = request.getParameter("username");
        String age = request.getParameter("userage");
        String gender = request.getParameter("gender");
        String country = request.getParameter("country");
        String[] courses = request.getParameterValues("courses");

        try {
            writer.println("&lt;p&gt;Name: " + name + "&lt;/p&gt;");
            writer.println("&lt;p&gt;Age: " + age + "&lt;/p&gt;");
            writer.println("&lt;p&gt;Gender: " + gender + "&lt;/p&gt;");
            writer.println("&lt;p&gt;Country: " + country + "&lt;/p&gt;");
            writer.println("&lt;h4&gt;Courses&lt;/h4&gt;");
            for (String course: courses) {
                writer.println("&lt;li&gt;" + course + "&lt;/li&gt;");
            }
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Данный сервлет будет обрабатывать запросы к по адресу <code>/hello</code>, на который отпавляется форма. Поскольку отправка формы осущетвляется с помощью метода <code>POST</code>, то для обработки запроса определен метод <code>doPost()</code>. Метод <code>doPost()</code> принимает те же параметры, что и метод <code>doGet()</code>.</p>
</div>
<div class="paragraph">
<p>С помощью методов <code>getParameter()</code> и <code>getParameterValues()</code> также получаем значения параметров. В данном случае названия параметров представляют названия полей ввода отправленной формы.</p>
</div>
<div class="paragraph">
<p>Причем поскольку на форме несколько чекбоксов, которые имеют одно и то же имя, то соответственно сервлету передается набор значений, который получаем с помощью метода <code>getParameterValues()</code>. Все остальные поля представляют одиночные значения, поэтому для получения их данных применяется метод <code>getParameter()</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/servlet12.jpg" alt="servlet12"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_переадресация_и_перенаправление_запроса">Переадресация и перенаправление запроса</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Одной из распространеных задач веб-программирования является переадресация. Рассмотрим, как мы можем в сервлетах выполнять переадресацию на другой ресурс.</p>
</div>
<div class="sect2">
<h3 id="_перенаправление_запроса">Перенаправление запроса</h3>
<div class="paragraph">
<p>Метод <code>forward()</code> класса <code>RequestDispatcher</code> позволяет перенаправить запрос из сервлета на другой сервлет, <code>html-страницу</code> или страницу <code>jsp</code>. Причем в данном случае речь идет о перенаправлении запроса, а не о переадресации.</p>
</div>
<div class="paragraph">
<p>Например, пусть в проекте определена страница <code>index.html</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Servlets in Java&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Index.html&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Данная страница просто выводит заголовок.</p>
</div>
<div class="paragraph">
<p>И, допустим, мы хотим из сервлета перенаправить запрос на эту страницу:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String path = "/index.html";
        ServletContext servletContext = getServletContext();
        RequestDispatcher requestDispatcher = servletContext.getRequestDispatcher(path);
        requestDispatcher.forward(request, response);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для того, чтобы выполнить перенаправление запроса, вначале с помощью метода <code>getServletContext()</code> получаем объект <code>ServletContext</code> , который представляет контекст запроса. Затем с помощью его метода <code>getRequestDispatcher()</code> получаем объект <code>RequestDispatcher</code> . Путь к ресурсу, на который надо выполнить перенаправление, передается в качестве параметра в <code>getRequestDispatcher()</code> .</p>
</div>
<div class="paragraph">
<p>Затем у объекта RequestDispatcher вызывается метод <code>forward()</code>, в который передаются объекты <code>HttpServletRequest</code> и <code>HttpServletResponse</code> .</p>
</div>
<div class="paragraph">
<p>И если мы обратимся к сервлету, то фактически мы получим содержимое страницы <code>index.html</code> , который будет перенаправлен запрос.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/jsp-hello.jpg" alt="JSP-hello"></span></p>
</div>
<div class="paragraph">
<p>Подобным образом мы можем выполнять перенаправление на страницы <code>jsp</code> и другие сервлеты. Например, добавим в проект новый сервлет <code>NotFoundServlet</code> :</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/not-found-servlet.jpg" alt="NotFoundServlet"></span></p>
</div>
<div class="paragraph">
<p>Определим для <code>NotFoundServlet</code> следующий код:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/notfound")
public class NotFoundServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        String id = request.getParameter("id");
        try {
            writer.println("&lt;h2&gt;Not Found: " + id + "&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае <code>NotFoundServlet</code> сопоставляется с адресом <code>/notfound</code>.</p>
</div>
<div class="paragraph">
<p>Изменим код <code>HelloServlet</code> , чтобы он перенаправлял на NotFoundServlet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {

        String path = "/notfound";
            ServletContext servletContext = getServletContext();
            RequestDispatcher requestDispatcher = servletContext.getRequestDispatcher(path);
            requestDispatcher.forward(request, response);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае если <code>id</code> равен <code>null</code> , то идет перенаправление на <code>NotFoundServlet</code>. Следует отметить, что в метод requestDispatcher.forward передаются объекты <code>HttpServletRequest</code> и <code>HttpServletResponse</code>. То есть <code>NotFoundServlet</code> получит те же самые данные запроса, что и <code>HelloServlet</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/jsp-not-found.jpg" alt="Not Found JSP-pages"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_переадресация">Переадресация</h3>
<div class="paragraph">
<p>Для переадресации применяется метод <code>sendRedirect()</code> объекта <code>HttpServletResponse</code>. В качестве параметра данный метод принимает адрес переадресации. Адрес может быть локальным, внутренним, а может быть и внешним.</p>
</div>
<div class="paragraph">
<p>Например, если сервлету <code>HelloServlet</code> не передано значение для параметра <code>id</code>, выполним переадресацию на сервлет <code>NotFoundServlet</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {
        String id = request.getParameter("id");
        if (id == null) {
            String path = request.getContextPath() + "/notfound";
            response.sendRedirect(path);
        } else {
            response.setContentType("text/html");
            PrintWriter writer = response.getWriter();
            try {
                writer.println("&lt;h2&gt;Hello Id " + id + "&lt;/h2&gt;");
            } finally {
                writer.close();
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае переадресация идет на локальный ресурс. Но важно понимать, что в метод <code>sendRedirect</code> передается адрес относительно корня текущего домена. То есть в данном случае у нас домен и порт <code><a href="http://localhost:8001/" class="bare">http://localhost:8001/</a></code>, а приложение называется <code>helloapp</code>, то для обращения к сервлету <code>NotFoundServlet</code> необходимо передать адрес <code>helloapp/notfound</code>. Путь к текущему приложению можно получить с помощью метода <code>getContextPath()</code>.</p>
</div>
<div class="paragraph">
<p>Также можно выполнять и переадресацию на внешний ресурс, указывая полный адрес:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">response.sendRedirect("https://metanit.com/");</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_xml_и_маппинг_сервлетов"><code>web.xml</code> и маппинг сервлетов</h2>
<div class="sectionbody">
<div class="paragraph">
<p>При определении сервлетов применялась аннотация <code>@WebServlet</code>, которая устанавливала конечную точку, с которой сопоставлялся сервлет. Например:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Вышеприведенный сервлет сопоставляется с путем <code>"/hello"</code>. То есть сервлет <code>HelloServlet</code> будет обрабатывать запросы типа <code>"<a href="http://localhost:8081/">название_приложения</a>/hello"</code> или <code>"<a href="http://somesite.com/">название_приложения</a>/hello"</code>.</p>
</div>
<div class="paragraph">
<p>Но есть и другой способ сопоставления путей и сервлетов. Он представляет использование файла <code>web.xml</code>.</p>
</div>
<div class="paragraph">
<p>Файл <code>web.xml</code> хранит информацию о конфигурации приложения. Он не является обязательной частью приложения, тем не менее он широко используется для настройки конфигурации.</p>
</div>
<div class="paragraph">
<p>Данный файл должен располагаться в папке <code>WEB-INF</code> приложения. При запуске <strong>Tomcat</strong> считывает его содержимое и использует считанную конфигурацию. Если же файл содержит ошибки, то <strong>Tomcat</strong> отображает ошибку.</p>
</div>
<div class="paragraph">
<p><code>web.xml</code> имеет определенную структуру. Все вложенные узлы, которые определяют конфигурацию, помещаются в корневой узел <code>&lt;web-app&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>У элемента <code>web-app</code> определяется ряд атрибутов. В данном случае атрибуты <code>xmlns</code> и <code>xmlns:xsi</code> указывают на используемые пространства имен <code>xml</code>. Атрибут <code>version</code> указывает на версию спецификации сервлетов или <code>Servlet API</code>, которая используется в приложении. Последняя версия <code>API</code> сервлетов - 4.0.</p>
</div>
<div class="paragraph">
<p>С помощью элемента <code>&lt;servlet-mapping&gt;</code> можно задать сопоставление сервлета с запрашиваемым <strong>URL</strong>.</p>
</div>
<div class="paragraph">
<p>Например, добавим в проект в <strong>Eclipse</strong> в директорию <code>WebConent/WEB-INF</code> новый файл <code>web.xml</code>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/config-servlets.jpg" alt="web.xml"></span></p>
</div>
<div class="paragraph">
<p>Определим в нем следующий код:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;HelloWorld&lt;/servlet-name&gt;
        &lt;servlet-class&gt;HelloServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;HelloWorld&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/welcome&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Прежде всего вначале с помощью элемента <code>&lt;servlet&gt;</code> определяется сервлет. Элемент <code>&lt;servlet-name&gt;</code> задает имя сервлета, на которое будет проецировать класс, указанный в элементе <code>&lt;servlet-class&gt;</code>. То есть, допустим, у нас проекте есть класс сервлета <code>HelloServlet</code>, который будет проецироваться на имя <code>HelloWorld</code>. Имя может быть произвольным и может совпадать с названием класса.</p>
</div>
<div class="paragraph">
<p>Затем в элементе <code>&lt;servlet-mapping&gt;</code> сервлет с именем <code>HelloWorld</code> (по сути сервлет <code>HelloServlet</code>) сопоставляется с путем <code>/welcome</code>.</p>
</div>
<div class="paragraph">
<p>Допустим, сервлет <code>HelloServlet</code> будет выглядеть следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        try {
            writer.println("&lt;h2&gt;Welcome to servlets&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Теперь, чтобы обратиться к этому сервлету, надо использовать путь <code>/welcome</code>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/request-welcome.jpg" alt="Request welcom"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_параметры_инициализации_сервлетов">Параметры инициализации сервлетов</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_общие_параметры">Общие параметры</h3>
<div class="paragraph">
<p>Элемент <code>&lt;context-param&gt;</code> в файле <code>web.xml</code> задает параметр, которым инициализируются сервлеты. Внутри этого элемента с помощью элемента <code>&lt;param-name&gt;</code> задается имя параметра, а с помощью элемента <code>&lt;param-value&gt;</code> - значение параметра.</p>
</div>
<div class="paragraph">
<p>Например, определим следующий файл <code>web.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;

    &lt;context-param&gt;
        &lt;param-name&gt;message&lt;/param-name&gt;
        &lt;param-value&gt;Hello Servlets&lt;/param-value&gt;
    &lt;/context-param&gt;

&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае параметр называется <code>message</code> и имеет значение <code>Hello Servlets</code>. Этот параметр доступен всем сервлетам в приложении.</p>
</div>
<div class="paragraph">
<p>Для получения параметра внутри сервлета необходимо обратиться к контексту сервлета. Для его получения внутри класса сервлета определен метод <code>getServletContext()</code>. Он возвращает объект <code>ServletContext</code>. Затем у этого объекта вызывается метод <code>getInitParameter()</code>, в который передается название параметра инициализации.</p>
</div>
<div class="paragraph">
<p>Например, получим выше определенный параметр в сервлете:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String message = getServletContext().getInitParameter("message");
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        try {
            writer.println("&lt;h2&gt;" + message + "&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/hello-page.jpg" alt="Hello page"></span></p>
</div>
<div class="paragraph">
<p>Стоит отметить, что этот параметр будет доступен для всех сервлетов в приложении. Соответственно если мы изменим в <code>web.xml</code> значение параметра, то оно изменится для всех сервлетов.</p>
</div>
</div>
<div class="sect2">
<h3 id="_параметры_для_отдельного_сервлета">Параметры для отдельного сервлета</h3>
<div class="paragraph">
<p>Кроме определения общих для всех сервлетов параметров, мы можем определить параметры непосредственно для конкретного сервлета. Для этого внутри элемента <code>&lt;servlet&gt;</code> определяется элемент <code>&lt;init-param&gt;</code></p>
</div>
<div class="paragraph">
<p>Например, изменим <code>web.xml</code> следующим образом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;HelloServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;HelloServlet&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;message&lt;/param-name&gt;
            &lt;param-value&gt;Hello Servlets&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/servlet&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Здесь также задан параметр <code>message</code> со значением <code>Hello Servlets</code>. Чтобы получить этот параметр в классе сервлете, необходимо использовать метод <code>getServletConfig()</code>, который возвращает объект <code>ServletConfig</code>. У него затем вызывается метод <code>getInitParameter()</code>, в который передается имя параметра. Например:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String message = getServletConfig().getInitParameter("message");
        response.setContentType("text/html");
        PrintWriter writer = response.getWriter();
        try {
            writer.println("&lt;h2&gt;" + message + "&lt;/h2&gt;");
        } finally {
            writer.close();
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_обработка_ошибок">Обработка ошибок</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Файл <code>web.xml</code> позволяет указать, какие страницы <strong>html</strong> или <strong>jsp</strong> будут отправляться пользователю при отправке статусных кодов ошибок. Для этого в <code>web.xml</code> применяется элемент <code>&lt;error-page&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Внутри этого элемента с помощью элемента <code>&lt;error-code&gt;</code> указывается статусный код ошибки, который надо обработать. А элемент <code>&lt;location&gt;</code> указывает на путь к странице <strong>html</strong> или <strong>jsp</strong>, которая будет отправляться пользователю.</p>
</div>
<div class="paragraph">
<p>Например, добавим в проект в папку <code>WebContent</code> новый файл <code>404.html</code> со следующим кодом:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Not Found&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Resource not found!&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/page-404.jpg" alt="Page 404"></span></p>
</div>
<div class="paragraph">
<p>В файле <code>web.xml</code> определим следующее содержимое:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;
    &lt;error-page&gt;
        &lt;error-code&gt;404&lt;/error-code&gt;
        &lt;location&gt;/404.html&lt;/location&gt;
    &lt;/error-page&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае элемент <code>error-code</code> указывает, что мы будем обрабатывать ошибки со статусным кодом <code>404</code> (то есть такие ошибки, которые подразумевают отсутствие ресурса на сервере). А элемент <code>location</code> указывает, что в случае обращения к несуществующему ресурсу пользователю будет отправляться страница <code>404.html</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/page-not-found.jpg" alt="Page Not Found"></span></p>
</div>
<div class="sect2">
<h3 id="_обработка_исключений">Обработка исключений</h3>
<div class="paragraph">
<p>Кроме настройки обработки стандартных ошибок протокола <strong>http</strong>, типа <strong>404</strong> или <strong>403</strong>, файл <code>web.xml</code> позволяет настроить обработку исключений, которые могут возникнуть при обработке запроса. Для этого в <code>web.xml</code> применяется элемент <code>&lt;exception-type&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Например, добавим в проект в папку <code>WebContent</code> новый файл <code>error.jsp</code> и определим в нем следующий код:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;%
   String message = pageContext.getException().getMessage();
   String exception = pageContext.getException().getClass().toString();
%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Exception&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Exception occurred while processing the request&lt;/h2&gt;
    &lt;p&gt;Type: &lt;%= exception%&gt;&lt;/p&gt;
    &lt;p&gt;Message: &lt;%= message %&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Данная страница <strong>jsp</strong> будет отображать информацию об исключении. Через глобальный объект <code>pageContext</code> в страницу передается контекст. Если при обработке запроса возникло какое-нибудь исключение, то метод <code>pageContext.getException()</code> возвратит это исключение в виде объекта <code>Exception</code>. И далее мы можем исследовать этот объект и вызывать его методы, например, получить тип исключения и сообщение об исключении.</p>
</div>
<div class="paragraph">
<p>Симитируем с сервлете какое-нибудь исключение:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        int x = 0;
        int y = 8 / x;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае мы получаем ошибку деления на нуль, которая представлена типом <code>java.lang.ArithmeticException</code>.</p>
</div>
<div class="paragraph">
<p>Теперь определим следующий файл <code>web.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                        http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0"&gt;
    &lt;error-page&gt;
        &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;
        &lt;location&gt;/error.jsp&lt;/location&gt;
    &lt;/error-page&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Элемент <code>exception-type</code> указывает, что обрабатываться будут исключения типа <code>java.lang.Throwable</code>. Поскольку это базовый класс для всех типов исключений, то фактически мы будем обрабатывать все исключения. Хотя можно конкретизировать тип исключения, например, указать тот же <code>java.lang.ArithmeticException</code>.</p>
</div>
<div class="paragraph">
<p>Элемент <code>location</code> определяет страницу, которая отправляется пользователю при возникновении исключении. В данном случае это <code>error.jsp</code>.</p>
</div>
<div class="paragraph">
<p>В итоге при обращении к сервлету будет сгенерировано исключение, и мы увидим информацию о нем:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/page-exception.jpg" alt="Page exception"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cookies">Cookies</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Куки</strong> представляют простейший способ хранения данных приложения. <strong>Куки</strong> хранятся в браузере польвователя в виде пары ключ-значение: с каждым уникальным ключом сопоставлется определенное значение. По ключу мы можем получить сохраненное в куках значение. Приложение на сервере может устанавливать куки и отправлять в ответе пользователю, после чего куки сохраняются в браузере. Когда клиент отправляет запроск приложению, то в запросе также отправляются и те куки, которые установлены данным приложением.</p>
</div>
<div class="paragraph">
<p><strong>Куки</strong> могут быть двух типов:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>сеансовые куки, т.е. когда пользователь закрывает вкладку браузера и прекращает работать с приложением, то куки сеанса уничтожаются.</p>
</li>
<li>
<p>постоянные куки - хранятся в течение продолжительного времени (до <code>3</code> лет).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Следует учитывать некоторые ограничения. Прежде всего куки нередко ограничены по размеру (обычно не более <strong>4 килобайт</strong>). Кроме того, обычно браузеры принимают не более <strong>20</strong> кук с одного сайта. Более того, в некоторых браузерах может быть отключена поддержка кук.</p>
</div>
<div class="paragraph">
<p>Для работы с куками сервлеты могут используют класс <code>javax.servlet.http.Cookie</code>. Для создания куки надо создать объект этого класса с помощью констуктора <code>Cookie(String name, String value)</code>, где <code>name</code> - ключ, а <code>value</code> - значение, которое сохраняется в куках. Стоит отметить, что мы можем сохранить в куках только строки.</p>
</div>
<div class="paragraph">
<p>Чтобы добавить куки в ответ клиенту у объекта <code>HttpServletResponse</code> применяется метод <code>addCookie(Cookie c)</code>.</p>
</div>
<div class="paragraph">
<p>При создании куки мы можем использовать ряд методов объекта <code>Cookie</code> для установки и получения отдельных параметров:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>setMaxAge(int maxAgeInSeconds)</code> устанавливает время в секундах, в течение которого будут существовать куки. Специальное значение <code>-1</code> указывает, что куки будут существовать только в течение сессии и после закрытия браузера будут удалены.</p>
</li>
<li>
<p><code>setValue(String value)</code> устанавливает хранимое значение.</p>
</li>
<li>
<p><code>getMaxAge()</code> возвращает время хранения кук.</p>
</li>
<li>
<p><code>getName()</code> возвращает ключ кук.</p>
</li>
<li>
<p><code>getValue()</code> возвращает значение кук.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Например, установка куки с названием <code>user</code> и значением <code>Tom</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Cookie cookie = new Cookie("user", "Tom");
response.addCookie(cookie);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Чтобы получить куки, которые приходят в запросе от клиента, применяется метод <code>getCookies()</code> класса <code>HttpServletRequest</code>.</p>
</div>
<div class="paragraph">
<p>Например, получение куки по имени:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Cookie[] cookies = request.getCookies();
String cookieName = "user";
Cookie cookie = null;
if(cookies != null) {
    for(Cookie c: cookies) {
        if(cookieName.equals(c.getName())) {
            cookie = c;
            break;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Получение куки по имени немного громоздко, поскольку нам надо перебрать набор полученных кук и сравнить их с нужным ключом. Поэтому при частном использовании, как правило, определяют вспомогаельные методы, которые инкапсулируют подобную функционалность.</p>
</div>
<div class="paragraph">
<p>Например, определим сервлет <code>SetServlet</code>, который будет устанавливать куки:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/set")
public class SetServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        PrintWriter out = response.getWriter();
        try {
            response.addCookie(new Cookie("user", "Tom"));
            out.println("Cookie is set");
        }
        finally {
            out.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае устанавливается куки <code>user</code>, которая хранит строку <code>Tom</code>.</p>
</div>
<div class="paragraph">
<p>Определим сервлет <code>HelloServlet</code>, который получает эту куку:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        Cookie[] cookies = request.getCookies();
        String cookieName = "user";
        Cookie cookie = null;
        if(cookies != null) {
            for(Cookie c: cookies) {
                if(cookieName.equals(c.getName())) {
                    cookie = c;
                    break;
                }
            }
        }
        PrintWriter out = response.getWriter();
        try {
            out.println("Name: " + cookie.getValue());
        }
        finally {
            out.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Таким образом, при обращении к сервлету <code>SetServlet</code> произойдет установка кук, а при обращении к сервлету <code>HelloServlet</code> мы получим установленные куки:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/cookies.png" alt="Cookies"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sessions">Sessions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Сессия позоляет сохранять некоторую информацию на время сеанса. Когда клиент обращается к сервлету или странице <code>JSP</code>, то движок сервлетов проверяет, определен ли в запросе параметр <code>ID</code> сессии. Если такой параметр неопределен (например, клиент первый раз обращается к приложению), тогда движок сервлетов создает уникальное значение <code>ID</code> и связанный с ним объект сессии. Объект сессии сохраняется на сервере, а <code>ID</code> отправляется в ответе клиенту и по умолчанию сохраняется на клиенте в куках. Затем когда приходит новый запрос от того же клиента, то движок сервлетов опять же может получить <code>ID</code> и сопоставить его с объектом сессии на веб-сервере.</p>
</div>
<div class="paragraph">
<p>Хотя по умолчанию <code>ID</code> сессии хранится в куках, но возможна ситуация, когда куки отключены на клиенте. Для решения этой проблемы есть ряд техник, в частности, добавление <code>ID</code> в адрес.</p>
</div>
<div class="paragraph">
<p>Для получения объекта сессии в сервлете у объекта <code>HttpServletRequest</code> определен метод <code>getSession()</code>. Он возвращает объект <code>HttpSession</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpSession session = request.getSession();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для управления сессией объект <code>HttpSession</code> предоставляет ряд методов:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>setAttribute(String name, Object o)</code> сохраняет в сессии под ключом <code>name</code></p>
</li>
<li>
<p><code>getAttribute(String name)</code> возвращает из сессии объект с ключом <code>name</code>. Если ключа <code>name</code> в сессии неопределено, то возвращается <code>null</code></p>
</li>
<li>
<p><code>removeAttribute(String name)</code> удаляет из сессии объект с ключом <code>name</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Например, определим следующий сервлет:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // получаем сессию
        HttpSession session = request.getSession();
        // получаем объект name
        String name = (String) session.getAttribute("name");

        PrintWriter out = response.getWriter();
        try {
            // если объект ранее не установлен
            if (name == null) {
                // устанавливаем объект с ключом name
                session.setAttribute("name", "Tom Soyer");
                out.println("Session data are set");
            } else {
                out.println("Name: " + name);
                // удаляем объект с ключом name
                session.removeAttribute("name");
            }
        } finally {
            out.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае мы получаем из сессии объект с ключом <code>name</code>. Если он не определен, то добавляем его в сессию, если определен - то удаляем. Таким образом, при первом запросе к приложению, в сессию будут добавлены данные, а при втором удалены, но мы сможем увидеть эти данные:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../assets/img/java/jakarta-ee/servlet/session.png" alt="Session"></span></p>
</div>
<div class="paragraph">
<p>Подобным образом можно сохранять в сессию более сложные объекты. Допустим, у нас есть следующий класс, который представляет пользователя:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Person {
    private String name;
    private int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public int getAge() {
        return age;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Сохраним в сессию и получим из сессии объект этого класса:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        HttpSession session = request.getSession();
        Person tom = (Person) session.getAttribute("person");

        PrintWriter out = response.getWriter();
        try {
            if (tom == null) {
                tom = new Person("Tom", 34);
                session.setAttribute("person", tom);
                out.println("Session data are set");
            } else {
                out.println("Name: " + tom.getName() + " Age: " + tom.getAge());
                session.removeAttribute("person");
            }
        } finally {
            out.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>В данном случае также если объект по ключу <code>person</code> не установлен, то он устанавливается, иначе удаляется.</p>
</div>
<div class="sect2">
<h3 id="_дополнительные_методы_httpsession">Дополнительные методы <code>HttpSession</code></h3>
<div class="paragraph">
<p>Кроме выше рассмотренных методов <code>HttpSession</code> есть еще ряд методов, которые могут быть полезны. Некоторые из них:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getAttributeNames()</code> возвращает объект <code>java.util.Enumeration</code>, который содержит все ключи имеющих в сессии объектов</p>
</li>
<li>
<p><code>getId()</code> возвращает идентификатор сессии в виде строки</p>
</li>
<li>
<p><code>isNew()</code> возвращает <code>true</code>, если для клиента еще не установлена сессия (клиент сделал первый запрос или на клиенте отключены куки)</p>
</li>
<li>
<p><code>setMaxInactiveInterval(int seconds)</code> устанавливает интервал неактивности в секундах. И если в течение этого интервала клиент был неактивен, то данные сессии данные удаляются. По умолчанию максимальный интервал неактивности <code>1800</code> секунд. Значение <code>-1</code> указывает, что сессия удаляется только тогда, когда пользователь закрыл вкладку в браузере.</p>
</li>
<li>
<p><code>invalidate()</code> удаляет из сессии все объекты</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Применение методов:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// получение всех ключей
Enumeration keys = session.getAttributeNames();
while (keys.hasMoreElements()) {
    System.out.println((String) keys.nextElement());
}

session.setMaxInactiveInterval(60 * 60 * 24); // установка интервала неактивности 1 день
session.setMaxInactiveInterval(-1); // до закрытия браузера

// удаление всех данных из сессии
session.invalidate();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-06-03 03:53:52 UTC
</div>
</div>
</body>
</html>